; ============================================================
; MeshSwarm Library - PlatformIO Configuration
; ============================================================
; Self-organizing ESP32 mesh network library
; https://github.com/edlovesjava/MeshSwarm

[platformio]
description = Self-organizing ESP32 mesh network library
default_envs = esp32
lib_dir = .
src_dir = examples/BasicNode

; ============================================================
; Common Settings
; ============================================================

[env]
platform = espressif32 @ 4.4.0
framework = arduino
monitor_speed = 115200
upload_speed = 921600
lib_deps =
    painlessMesh @ ^1.5.0
    bblanchon/ArduinoJson @ ^7.0.0
    adafruit/Adafruit SSD1306 @ ^2.5.0
    adafruit/Adafruit GFX Library @ ^1.11.0
    adafruit/Adafruit BusIO @ ^1.14.0
    adafruit/DHT sensor library @ ^1.4.6
    adafruit/Adafruit Unified Sensor @ ^1.1.14
; Ignore ESPAsyncTCP - it's for ESP8266 only, ESP32 uses AsyncTCP
lib_ignore = ESPAsyncTCP

; ============================================================
; Board Environments
; ============================================================

[env:esp32]
board = esp32dev
build_flags = 
    -DCORE_DEBUG_LEVEL=3

[env:esp32s3]
board = esp32-s3-devkitc-1
build_flags = 
    -DCORE_DEBUG_LEVEL=3
    -DARDUINO_USB_CDC_ON_BOOT=1

[env:esp32c3]
board = esp32-c3-devkitc-02
build_flags = 
    -DCORE_DEBUG_LEVEL=3

; ============================================================
; Test Environments - Feature Flags
; ============================================================

[env:test-minimal]
board = esp32dev
build_flags = 
    -DMESHSWARM_ENABLE_DISPLAY=0
    -DMESHSWARM_ENABLE_SERIAL=0
    -DMESHSWARM_ENABLE_TELEMETRY=0
    -DMESHSWARM_ENABLE_OTA=0
    -DMESHSWARM_ENABLE_CALLBACKS=0

[env:test-core-display]
board = esp32dev
build_flags = 
    -DMESHSWARM_ENABLE_SERIAL=0
    -DMESHSWARM_ENABLE_TELEMETRY=0
    -DMESHSWARM_ENABLE_OTA=0

[env:test-core-serial]
board = esp32dev
build_flags = 
    -DMESHSWARM_ENABLE_DISPLAY=0
    -DMESHSWARM_ENABLE_TELEMETRY=0
    -DMESHSWARM_ENABLE_OTA=0

[env:test-telemetry]
board = esp32dev
build_flags = 
    -DMESHSWARM_ENABLE_DISPLAY=0
    -DMESHSWARM_ENABLE_SERIAL=1
    -DMESHSWARM_ENABLE_TELEMETRY=1
    -DMESHSWARM_ENABLE_OTA=0

[env:test-ota]
board = esp32dev
build_flags = 
    -DMESHSWARM_ENABLE_DISPLAY=0
    -DMESHSWARM_ENABLE_SERIAL=1
    -DMESHSWARM_ENABLE_TELEMETRY=0
    -DMESHSWARM_ENABLE_OTA=1

[env:test-gateway]
board = esp32dev
build_flags = 
    -DMESHSWARM_ENABLE_DISPLAY=1
    -DMESHSWARM_ENABLE_SERIAL=1
    -DMESHSWARM_ENABLE_TELEMETRY=1
    -DMESHSWARM_ENABLE_OTA=1

; ============================================================
; Log Level Tests
; ============================================================

[env:test-log-none]
board = esp32dev
build_flags = 
    -DMESHSWARM_LOG_LEVEL=0

[env:test-log-error]
board = esp32dev
build_flags =
    -DMESHSWARM_LOG_LEVEL=1

